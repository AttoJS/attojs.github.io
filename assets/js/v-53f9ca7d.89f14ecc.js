(self.webpackChunkvue_request_doc=self.webpackChunkvue_request_doc||[]).push([[923],{6731:(n,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>V});var e=s(8133);const t=(0,e.uE)('<h1 id="公共-api"><a class="header-anchor" href="#公共-api">#</a> 公共 API</h1><p>VueRequest 通常由 <a href="#result">Result</a>、<a href="#service">Service</a> 和 <a href="#options">Options</a> 三个部分组成</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token operator">...</span>result <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span>service<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre></div><h2 id="result"><a class="header-anchor" href="#result">#</a> Result</h2><h3 id="loading"><a class="header-anchor" href="#loading">#</a> loading</h3><ul><li><p><strong>类型：</strong> <code>Ref&lt;boolean&gt;</code></p></li><li><p><strong>默认值：</strong> <code>false</code></p><p><strong>Service</strong> 请求的执行状态</p></li></ul><h3 id="data"><a class="header-anchor" href="#data">#</a> data</h3>',7),l=(0,e.Wm)("li",null,[(0,e.Wm)("p",null,[(0,e.Wm)("strong",null,"类型:"),(0,e.Uk)(),(0,e.Wm)("code",null,"Ref<R | undefined>")])],-1),o=(0,e.Wm)("p",null,[(0,e.Wm)("strong",null,"默认值："),(0,e.Uk)(),(0,e.Wm)("code",null,"undefined")],-1),r=(0,e.Uk)("接口返回的数据，如果有传入 "),c=(0,e.Uk)("formatResult"),p=(0,e.Uk)("，则为格式化后的 "),u=(0,e.Wm)("code",null,"data",-1),i=(0,e.uE)('<h3 id="error"><a class="header-anchor" href="#error">#</a> error</h3><ul><li><p><strong>类型:</strong> <code>Ref&lt;Error | undefined&gt;</code></p></li><li><p><strong>默认值：</strong> <code>undefined</code></p><p>如果在内部抛出了一个错误，则会被 <code>error</code> 接收并返回</p></li></ul><h3 id="params"><a class="header-anchor" href="#params">#</a> params</h3><ul><li><p><strong>类型:</strong> <code>Ref&lt;P[]&gt;</code></p></li><li><p><strong>默认值：</strong> <code>[]</code></p><p><strong>Service</strong> 的请求参数</p></li><li><p><strong>示例</strong></p></li></ul><div class="language-typescript ext-ts"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">getUser</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;api/user?&#39;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> <span class="token punctuation">{</span> params<span class="token punctuation">,</span> run <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span>getUser<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n  defaultParams<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;John&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// 默认请求时，如果存在 defaultParams， 则 params.value 将会等于 defaultParams，否则为空数组</span>\n\n<span class="token comment">// 当 run 传入参数时，此时的参数将会同步到 params 里面</span>\n<span class="token function">run</span><span class="token punctuation">(</span><span class="token string">&#39;Benny&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// params.value 等于 [&#39;Benny&#39;]</span>\n</code></pre></div><h3 id="run"><a class="header-anchor" href="#run">#</a> run</h3>',6),d=(0,e.Wm)("p",null,[(0,e.Wm)("strong",null,"类型:"),(0,e.Uk)(),(0,e.Wm)("code",null,"(...arg: P[]) => Promise<R>")],-1),h=(0,e.Wm)("p",null,[(0,e.Uk)("手动触发 "),(0,e.Wm)("strong",null,"Service"),(0,e.Uk)(" 的请求")],-1),k={class:"custom-container tip"},g=(0,e.Wm)("p",{class:"custom-container-title"},"注意",-1),m=(0,e.Uk)("当开启了 "),f=(0,e.Uk)("debounceInterval"),v=(0,e.Uk)(" 或者 "),W=(0,e.Uk)("throttleInterval"),y=(0,e.Uk)(" 模式后 "),R=(0,e.Wm)("code",null,"run",-1),w=(0,e.Uk)(" 的返回结果有可能是 "),U=(0,e.Wm)("code",null,"Promise<null>",-1),b=(0,e.Wm)("h3",{id:"cancel"},[(0,e.Wm)("a",{class:"header-anchor",href:"#cancel"},"#"),(0,e.Uk)(" cancel")],-1),q=(0,e.Wm)("p",null,[(0,e.Wm)("strong",null,"类型:"),(0,e.Uk)(),(0,e.Wm)("code",null,"() => void")],-1),P=(0,e.Wm)("li",null,"手动取消本次请求",-1),I=(0,e.Uk)("停止"),D=(0,e.Uk)("轮询"),_=(0,e.Uk)("功能"),E=(0,e.Wm)("div",{class:"custom-container tip"},[(0,e.Wm)("p",{class:"custom-container-title"},"注意"),(0,e.Wm)("p",null,[(0,e.Uk)("这里说的取消"),(0,e.Wm)("strong",null,"并不是真正的停止请求"),(0,e.Uk)("，只是取消了对 "),(0,e.Wm)("a",{href:"#data"},"data"),(0,e.Uk)(" 的赋值以及 "),(0,e.Wm)("a",{href:"#loading"},"loading"),(0,e.Uk)(" 重置为 "),(0,e.Wm)("code",null,"false"),(0,e.Uk)(" 当前的接口请求依旧会继续进行")])],-1),S=(0,e.uE)('<h3 id="refresh"><a class="header-anchor" href="#refresh">#</a> refresh</h3><ul><li><p><strong>类型:</strong> <code>() =&gt; Promise&lt;R&gt;</code></p><p>使用当前的 <a href="#run">params</a> 重新调用 <a href="#run">run</a></p></li></ul><h3 id="mutate"><a class="header-anchor" href="#mutate">#</a> mutate</h3>',3),z=(0,e.Wm)("li",null,[(0,e.Wm)("p",null,[(0,e.Wm)("strong",null,"类型:"),(0,e.Uk)(),(0,e.Wm)("code",null,"(arg: (oldData: R) => R) => void | (newData: R) => void")]),(0,e.Wm)("p",null,[(0,e.Uk)("直接修改 "),(0,e.Wm)("a",{href:"#data"},"data"),(0,e.Uk)(" 的结果")])],-1),O=(0,e.Wm)("strong",null,"参考",-1),T=(0,e.Uk)("突变"),j=(0,e.Wm)("h3",{id:"queries"},[(0,e.Wm)("a",{class:"header-anchor",href:"#queries"},"#"),(0,e.Uk)(" queries")],-1),x=(0,e.Wm)("p",null,[(0,e.Wm)("strong",null,"类型:"),(0,e.Uk)(),(0,e.Wm)("code",null,"Queries<R, P>")],-1),K=(0,e.Uk)("默认情况下，新请求的数据将会覆盖旧请求的数据。当启用 "),C=(0,e.Uk)("queryKey"),H=(0,e.Uk)(" 后， "),Q=(0,e.Wm)("code",null,"queries",-1),A=(0,e.Uk)(" 能够同时存储多次请求的结果，实现并行的效果"),B=(0,e.uE)('<p><code>Queries</code> 的类型如下</p><div class="language-typescript ext-ts"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">Queries<span class="token operator">&lt;</span><span class="token constant">R</span><span class="token punctuation">,</span> <span class="token constant">P</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>\n  loading<span class="token operator">:</span> Ref<span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>\n  data<span class="token operator">:</span> Ref<span class="token operator">&lt;</span><span class="token constant">R</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>\n  error<span class="token operator">:</span> Ref<span class="token operator">&lt;</span>Error <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>\n  params<span class="token operator">:</span> Ref<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>\n  <span class="token function-variable function">run</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token operator">...</span>arg<span class="token operator">:</span> <span class="token constant">P</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">R</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>\n  <span class="token function-variable function">cancel</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n  <span class="token function-variable function">refresh</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">R</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>\n  <span class="token function-variable function">mutate</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token function-variable function">arg</span><span class="token operator">:</span> <span class="token punctuation">(</span>oldData<span class="token operator">:</span> <span class="token constant">R</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">R</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span> <span class="token operator">|</span> <span class="token punctuation">(</span>newData<span class="token operator">:</span> <span class="token constant">R</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre></div>',2),F=(0,e.Wm)("strong",null,"参考",-1),L=(0,e.Uk)("并行请求"),J=(0,e.uE)('<h2 id="service"><a class="header-anchor" href="#service">#</a> Service</h2><p>TODO</p><h2 id="options"><a class="header-anchor" href="#options">#</a> Options</h2><h3 id="loadingdelay"><a class="header-anchor" href="#loadingdelay">#</a> loadingDelay</h3><ul><li><strong>类型</strong>: <code>number</code></li></ul><h3 id="pollinginterval"><a class="header-anchor" href="#pollinginterval">#</a> pollingInterval</h3><ul><li><strong>类型</strong>: <code>number</code></li></ul><h3 id="pollingwhenhidden"><a class="header-anchor" href="#pollingwhenhidden">#</a> pollingWhenHidden</h3><ul><li><strong>类型</strong>: <code>boolean</code></li></ul><h3 id="pollingwhenoffline"><a class="header-anchor" href="#pollingwhenoffline">#</a> pollingWhenOffline</h3><ul><li><strong>类型</strong>: <code>boolean</code></li></ul><h3 id="debounceinterval"><a class="header-anchor" href="#debounceinterval">#</a> debounceInterval</h3><ul><li><strong>类型</strong>: <code>number</code></li></ul><h3 id="throttleinterval"><a class="header-anchor" href="#throttleinterval">#</a> throttleInterval</h3><ul><li><strong>类型</strong>: <code>number</code></li></ul><h3 id="refreshonwindowfocus"><a class="header-anchor" href="#refreshonwindowfocus">#</a> refreshOnWindowFocus</h3><ul><li><strong>类型</strong>: <code>boolean</code></li></ul><h3 id="refocustimespan"><a class="header-anchor" href="#refocustimespan">#</a> refocusTimespan</h3><ul><li><strong>类型</strong>: <code>number</code></li></ul><h3 id="cachetime"><a class="header-anchor" href="#cachetime">#</a> cacheTime</h3><ul><li><strong>类型</strong>: <code>number</code></li></ul><h3 id="staletime"><a class="header-anchor" href="#staletime">#</a> staleTime</h3><ul><li><strong>类型</strong>: <code>number</code></li></ul><h3 id="errorretrycount"><a class="header-anchor" href="#errorretrycount">#</a> errorRetryCount</h3><ul><li><strong>类型</strong>: <code>number</code></li></ul><h3 id="errorretryinterval"><a class="header-anchor" href="#errorretryinterval">#</a> errorRetryInterval</h3><ul><li><strong>类型</strong>: <code>number</code></li></ul><h3 id="manual"><a class="header-anchor" href="#manual">#</a> manual</h3><ul><li><strong>类型</strong>: <code>boolean</code></li></ul><h3 id="defaultparams"><a class="header-anchor" href="#defaultparams">#</a> defaultParams</h3><ul><li><strong>类型</strong>: <code>P[]</code></li></ul><h3 id="ready"><a class="header-anchor" href="#ready">#</a> ready</h3><ul><li><strong>类型</strong>: <code>Ref&lt;boolean&gt;</code></li></ul><h3 id="initialdata"><a class="header-anchor" href="#initialdata">#</a> initialData</h3><ul><li><strong>类型</strong>: <code>R</code></li></ul><h3 id="refreshdeps"><a class="header-anchor" href="#refreshdeps">#</a> refreshDeps</h3><ul><li><strong>类型</strong>: <code>WatchSource&lt;any&gt;[]</code></li></ul><h3 id="cachekey"><a class="header-anchor" href="#cachekey">#</a> cacheKey</h3><ul><li><strong>类型</strong>: <code>string</code></li></ul><h3 id="querykey"><a class="header-anchor" href="#querykey">#</a> queryKey</h3><ul><li><strong>类型</strong>: <code>(...args: P[]) =&gt; string</code></li></ul><h3 id="formatresult"><a class="header-anchor" href="#formatresult">#</a> formatResult</h3><ul><li><strong>类型</strong>: <code>(data: any) =&gt; R</code></li></ul><h3 id="onsuccess"><a class="header-anchor" href="#onsuccess">#</a> onSuccess</h3><ul><li><strong>类型</strong>: <code>(data: R, params: P[]) =&gt; void</code></li></ul><h3 id="onerror"><a class="header-anchor" href="#onerror">#</a> onError</h3><ul><li><strong>类型</strong>: <code>(error: Error, params: P[]) =&gt; void</code></li></ul>',47),V={render:function(n,a){const s=(0,e.up)("RouterLink");return(0,e.wg)(),(0,e.j4)(e.HY,null,[t,(0,e.Wm)("ul",null,[l,(0,e.Wm)("li",null,[o,(0,e.Wm)("p",null,[r,(0,e.Wm)(s,{to:"/vue-request-docs/zh/api/options.html#formatresult"},{default:(0,e.w5)((()=>[c])),_:1}),p,u])])]),i,(0,e.Wm)("ul",null,[(0,e.Wm)("li",null,[d,h,(0,e.Wm)("div",k,[g,(0,e.Wm)("p",null,[m,(0,e.Wm)(s,{to:"/vue-request-docs/zh/api/options.html#debounceinterval"},{default:(0,e.w5)((()=>[f])),_:1}),v,(0,e.Wm)(s,{to:"/vue-request-docs/zh/api/options.html#throttleinterval"},{default:(0,e.w5)((()=>[W])),_:1}),y,R,w,U])])])]),b,(0,e.Wm)("ul",null,[(0,e.Wm)("li",null,[q,(0,e.Wm)("ul",null,[P,(0,e.Wm)("li",null,[I,(0,e.Wm)(s,{to:"/vue-request-docs/zh/api/options.html#pollinginterval"},{default:(0,e.w5)((()=>[D])),_:1}),_])]),E])]),S,(0,e.Wm)("ul",null,[z,(0,e.Wm)("li",null,[(0,e.Wm)("p",null,[O,(0,e.Wm)(s,{to:"/vue-request-docs/zh/guide/documents/mutate.html"},{default:(0,e.w5)((()=>[T])),_:1})])])]),j,(0,e.Wm)("ul",null,[(0,e.Wm)("li",null,[x,(0,e.Wm)("p",null,[K,(0,e.Wm)(s,{to:"/vue-request-docs/zh/api/options.html#querykey"},{default:(0,e.w5)((()=>[C])),_:1}),H,Q,A]),B]),(0,e.Wm)("li",null,[(0,e.Wm)("p",null,[F,(0,e.Wm)(s,{to:"/vue-request-docs/zh/guide/documents/queries.html"},{default:(0,e.w5)((()=>[L])),_:1})])])]),J],64)}}},6266:(n,a,s)=>{"use strict";s.r(a),s.d(a,{data:()=>e});const e={key:"v-53f9ca7d",path:"/zh/api/",title:"公共 API",frontmatter:{},excerpt:"",headers:[{level:2,title:"Result",slug:"result",children:[{level:3,title:"loading",slug:"loading",children:[]},{level:3,title:"data",slug:"data",children:[]},{level:3,title:"error",slug:"error",children:[]},{level:3,title:"params",slug:"params",children:[]},{level:3,title:"run",slug:"run",children:[]},{level:3,title:"cancel",slug:"cancel",children:[]},{level:3,title:"refresh",slug:"refresh",children:[]},{level:3,title:"mutate",slug:"mutate",children:[]},{level:3,title:"queries",slug:"queries",children:[]}]},{level:2,title:"Service",slug:"service",children:[]},{level:2,title:"Options",slug:"options",children:[{level:3,title:"loadingDelay",slug:"loadingdelay",children:[]},{level:3,title:"pollingInterval",slug:"pollinginterval",children:[]},{level:3,title:"pollingWhenHidden",slug:"pollingwhenhidden",children:[]},{level:3,title:"pollingWhenOffline",slug:"pollingwhenoffline",children:[]},{level:3,title:"debounceInterval",slug:"debounceinterval",children:[]},{level:3,title:"throttleInterval",slug:"throttleinterval",children:[]},{level:3,title:"refreshOnWindowFocus",slug:"refreshonwindowfocus",children:[]},{level:3,title:"refocusTimespan",slug:"refocustimespan",children:[]},{level:3,title:"cacheTime",slug:"cachetime",children:[]},{level:3,title:"staleTime",slug:"staletime",children:[]},{level:3,title:"errorRetryCount",slug:"errorretrycount",children:[]},{level:3,title:"errorRetryInterval",slug:"errorretryinterval",children:[]},{level:3,title:"manual",slug:"manual",children:[]},{level:3,title:"defaultParams",slug:"defaultparams",children:[]},{level:3,title:"ready",slug:"ready",children:[]},{level:3,title:"initialData",slug:"initialdata",children:[]},{level:3,title:"refreshDeps",slug:"refreshdeps",children:[]},{level:3,title:"cacheKey",slug:"cachekey",children:[]},{level:3,title:"queryKey",slug:"querykey",children:[]},{level:3,title:"formatResult",slug:"formatresult",children:[]},{level:3,title:"onSuccess",slug:"onsuccess",children:[]},{level:3,title:"onError",slug:"onerror",children:[]}]}],filePathRelative:"zh/api/index.md",git:{updatedTime:1613807088e3,contributors:[]}}}}]);